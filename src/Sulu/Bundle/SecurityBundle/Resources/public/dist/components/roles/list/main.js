define(["services/sulusecurity/role-router","services/sulusecurity/role-manager"],function(a,b){"use strict";var c={datagridInstanceName:"roles",toolbarInstanceName:"roles"},d=function(){this.sandbox.on("sulu.toolbar.add",a.toAdd),this.sandbox.on("sulu.toolbar.delete",function(){this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".items.get-selected",function(a){this.sandbox.sulu.showDeleteDialog(function(b){b&&e.call(this,a)}.bind(this))}.bind(this))}.bind(this)),this.sandbox.on("husky.datagrid."+c.datagridInstanceName+".number.selections",function(a){var b=a>0?"enable":"disable";this.sandbox.emit("sulu.header.toolbar.item."+b,"deleteSelected",!1)}.bind(this))},e=function(a){b["delete"](a).then(function(){this.sandbox.emit("sulu.labels.success.show","sulu-security.role.removed"),this.sandbox.util.foreach(a,function(a){this.sandbox.emit("husky.datagrid."+c.datagridInstanceName+".record.remove",a)}.bind(this))}.bind(this)).fail(function(){this.sandbox.emit("sulu.labels.error.show")}.bind(this))};return{stickyToolbar:!0,name:"Sulu Security Role List",layout:{content:{width:"max"}},header:function(){return{noBack:!0,title:"security.roles.title",underline:!1,toolbar:{buttons:{add:{},deleteSelected:{},"export":{options:{urlParameter:{flat:!0},url:"/admin/api/roles.csv"}}}}}},templates:["/admin/security/template/role/list"],initialize:function(){this.initializeDataGrid(),d.call(this)},initializeDataGrid:function(){this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/security/template/role/list")),this.sandbox.sulu.initListToolbarAndList.call(this,"roles","/admin/api/roles/fields",{el:this.$find("#list-toolbar-container"),instanceName:c.toolbarInstanceName,groups:[{id:1,align:"left"},{id:2,align:"right"}]},{el:this.sandbox.dom.find("#roles-list",this.$el),url:"/admin/api/roles?flat=true",searchInstanceName:"roles",storageName:"roles",searchFields:["id","name","system"],resultKey:"roles",instanceName:c.datagridInstanceName,actionCallback:a.toEdit},"roles","#roles-list-info")}}});