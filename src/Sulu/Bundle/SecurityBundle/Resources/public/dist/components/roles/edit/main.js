define(["services/sulusecurity/role-manager","services/sulusecurity/role-router"],function(a,b){"use strict";return{collaboration:function(){return this.options.id?{id:this.options.id,type:"roles"}:void 0},loadComponentData:function(){return this.options.id?a.load(this.options.id):{name:"",permissions:[],system:""}},header:function(){var a={tabs:{url:"/admin/content-navigations?alias=roles",options:{data:function(){return this.data}.bind(this)},componentOptions:{values:this.data}},toolbar:{buttons:{save:{parent:"saveWithOptions"}}}};return this.options.id&&(a.toolbar.buttons["delete"]={}),a},initialize:function(){this.action=null,this.bindCustomEvents()},bindCustomEvents:function(){this.sandbox.on("sulu.header.back",b.toList),this.sandbox.on("sulu.toolbar.delete",this.deleteRole.bind(this)),this.sandbox.on("sulu.tab.dirty",this.enableSave.bind(this)),this.sandbox.on("sulu.router.navigate",this.disableSave.bind(this)),this.sandbox.on("sulu.toolbar.save",this.saveTab.bind(this)),this.sandbox.on("sulu.tab.saving",this.loadingSave.bind(this)),this.sandbox.on("sulu.tab.data-changed",this.changeData.bind(this)),this.sandbox.on("sulu.tab.saved",this.tabSavedHandler.bind(this)),this.sandbox.on("sulu.tab.save-error",this.saveErrorHandler.bind(this))},changeData:function(a){this.data=a},enableSave:function(){this.sandbox.emit("sulu.header.toolbar.item.enable","save",!1)},disableSave:function(){this.sandbox.emit("sulu.header.toolbar.item.disable","save",!1)},loadingSave:function(){this.sandbox.emit("sulu.header.toolbar.item.loading","save")},saveErrorHandler:function(a){var b="";this.disableSave(),1101==a&&(b="security.roles.error.non-unique"),this.sandbox.emit("sulu.labels.error.show",b)},deleteRole:function(){this.sandbox.sulu.showDeleteDialog(function(c){c&&a["delete"](this.options.id).then(function(){b.toList()}.bind(this))}.bind(this))},saveTab:function(a){this.action=a,this.sandbox.emit("sulu.tab.save")},tabSavedHandler:function(a,b){this.sandbox.emit("sulu.labels.success.show","sulu-security.role.saved"),this.sandbox.emit("sulu.labels.warning.show","security.warning"),b&&this.changeData(a),this.afterSave(a)},afterSave:function(a){this.sandbox.emit("sulu.header.toolbar.item.disable","save",!0),this.sandbox.emit("sulu.header.saved",a),"back"===this.action?b.toList():"new"===this.action?b.toAdd():this.options.id||b.toEdit(a.id)}}});