define(function(){"use strict";var a={large:!1,fadeInDuration:400,unselectOnBackgroundClick:!0,selectable:!0},b={containerClass:"contact-thumbnails",itemClass:"item",titleClass:"title",checkboxClass:"checkbox",descriptionClass:"description",thumbnailSrcProperty:"url",thumbnailAltProperty:"alt",idProperty:"id",textClass:"text",imageClass:"image",descriptionDelimiter:", ",selectedClass:"is-selected"},c={item:['<div class="'+b.itemClass+'">','   <div class="item-head">','       <div class="head-container">','           <div class="'+b.imageClass+'" style="background-image: url(\'<%= picture %>\')"></div>','           <div class="head-name"><%= name %></div>',"       </div>",'       <div class="head-checkbox"></div>','       <div class="head-sulubox"></div>',"   </div>",'   <div class="item-info">','       <div class="info-row">','           <span class="fa-map-marker info-icon"></span>','           <span class="info-text"><%= location %></span>',"       </div>",'       <div class="info-row">','           <span class="fa-envelope info-icon"></span>','           <span class="info-text"><%= mail %></span>',"       </div>","   </div>","</div>"].join("")};return{initialize:function(b,c){this.datagrid=b,this.sandbox=this.datagrid.sandbox,this.options=this.sandbox.util.extend(!0,{},a,c),this.setVariables()},setVariables:function(){this.rendered=!1,this.data=null,this.$el=null,this.$items={}},render:function(a,c){this.data=a,this.$el=this.sandbox.dom.createElement('<div class="'+b.containerClass+'"/>'),this.sandbox.dom.append(c,this.$el),this.renderItems(this.data.embedded),this.sandbox.dom.on("body","click.grid-thumbnails."+this.datagrid.options.instanceName,function(){this.options.unselectOnBackgroundClick&&this.unselectAllItems()}.bind(this)),this.rendered=!0},renderItems:function(a){this.sandbox.util.foreach(a,function(a){var c,d,e,f,g,h;c=a[b.idProperty],d="/bundles/sulucontact/sample.jpg",e=[a.firstName,a.lastName].join(" "),f=!1,g="Testhausen 8, AT",h=a.mainEmail,this.renderItem(c,d,e,f,g,h)}.bind(this))},renderItem:function(a,b,d,e,f,g){this.$items[a]=this.sandbox.dom.createElement(this.sandbox.util.template(c.item)({picture:b,name:this.sandbox.util.cropMiddle(String(d),32),checked:!!this.datagrid.itemIsSelected.call(this.datagrid,a),isSuluUser:!1,location:this.sandbox.util.cropMiddle(String(f),32),mail:this.sandbox.util.cropMiddle(String(g),32)})),this.datagrid.itemIsSelected.call(this.datagrid,a)&&this.selectItem(a,!0),this.sandbox.dom.data(this.$items[a],"id",a),this.sandbox.dom.hide(this.$items[a]),this.sandbox.dom.append(this.$el,this.$items[a]),this.sandbox.dom.fadeIn(this.$items[a],this.options.fadeInDuration),this.bindItemDomEvents(a)},destroy:function(){this.sandbox.dom.off("body","click.grid-thumbnails."+this.datagrid.options.instanceName),this.sandbox.dom.remove(this.$el)},bindItemDomEvents:function(a){this.sandbox.dom.on(this.$items[a],"click",function(b){this.sandbox.dom.stopPropagation(b),this.options.selectable?this.toggleItemSelected(a):this.selectItem(a)}.bind(this)),this.sandbox.dom.on(this.$items[a],"click",function(b){this.sandbox.dom.stopPropagation(b),this.downloadHandler(a)}.bind(this),"."+b.downloadClass),this.sandbox.dom.on(this.$items[a].find("img"),"error",function(){this.$items[a].find("img").remove()}.bind(this)),this.sandbox.dom.on(this.$items[a].find("img"),"load",function(){this.$items[a].find(".fa-coffee").remove()}.bind(this)),this.options.selectable&&this.sandbox.dom.on(this.$items[a],"dblclick",function(){this.datagrid.itemAction.call(this.datagrid,a),this.selectItem(a)}.bind(this))},selectRecord:function(a){this.selectItem(a,!1)},deselectAllRecords:function(){this.unselectAllItems()},toggleItemSelected:function(a){this.datagrid.itemIsSelected.call(this.datagrid,a)===!0?this.unselectItem(a,!1):this.selectItem(a,!1)},selectItem:function(a,c){this.options.selectable?(this.sandbox.dom.addClass(this.$items[a],b.selectedClass),this.sandbox.dom.is(this.sandbox.dom.find('input[type="checkbox"]',this.$items[a]),":checked")||this.sandbox.dom.prop(this.sandbox.dom.find('input[type="checkbox"]',this.$items[a]),"checked",!0),c!==!0&&this.datagrid.setItemSelected.call(this.datagrid,a)):this.datagrid.itemAction(a)},unselectItem:function(a,c){this.sandbox.dom.removeClass(this.$items[a],b.selectedClass),this.sandbox.dom.is(this.sandbox.dom.find('input[type="checkbox"]',this.$items[a]),":checked")&&this.sandbox.dom.prop(this.sandbox.dom.find('input[type="checkbox"]',this.$items[a]),"checked",!1),c!==!0&&this.datagrid.setItemUnselected.call(this.datagrid,a)},addRecord:function(a){this.renderItems([a])},downloadHandler:function(a){this.sandbox.emit(DOWNLOAD_CLICKED.call(this),a)},removeRecord:function(a){return this.$items[a]?(this.sandbox.dom.remove(this.$items[a]),this.datagrid.removeRecord.call(this.datagrid,a),!0):!1},unselectAllItems:function(){this.sandbox.util.each(this.$items,function(a){this.unselectItem(a,!0)}.bind(this)),this.datagrid.deselectAllItems.call(this.datagrid)}}});