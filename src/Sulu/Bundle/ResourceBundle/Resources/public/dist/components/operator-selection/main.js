define([],function(){"use strict";var a={operatorsUrl:null,fieldsUrl:null,eventNamespace:"sulu.operator-selection",dataAttribute:"operator-selection",instanceName:"operator",translations:{addButton:"resource.filter.add-condition"},data:[]},b={container:function(a){return'<div class="operator-container" id="'+a+'" style="display:none"></div>'},button:function(a,b){return['<div class="grid-row">','<div class="grid-col-3">','<div id="',a,'" class="btn action">',b,"</div>","</div>","</div>"].join("")},row:function(a){return['<div class="operator-row grid-row" data-id="',a,'"></div>'].join("")},removeButton:function(a){return['<div class="grid-col-1 align-center pointer ',a,'">','<span class="fa-minus-circle m-top-7"></span>',"</div>"].join("")}},c={operatorSelectSelector:"operator-select",fieldSelectSelector:"field-select",removeButtonClass:"operator-remove"},d=function(){return e.call(this,"initialized")},e=function(a){return this.options.eventNamespace+"."+(this.options.instanceName?this.options.instanceName+".":"")+a},f=function(){var a=this.sandbox.dom.createElement('<div id="'+this.options.ids.loader+'"></div>');this.sandbox.dom.append(this.options.el,a),this.sandbox.start([{name:"loader@husky",options:{el:a,size:"100px",color:"#cccccc"}}])},g=function(){this.sandbox.stop("#"+this.options.ids.loader)},h=function(){this.options.data&&this.options.data.length>0&&this.options.data.forEach(function(a){i.call(this,a)}.bind(this))},i=function(a){var d=a.conditions[0],e=this.sandbox.dom.createElement(b.row(a.id)),f=this.sandbox.dom.createElement(b.removeButton(c.removeButtonClass)),g=j.call(this,d.field,"name","translation",this.fields,c.fieldSelectSelector,"grid-col-4"),h=j.call(this,d.operator,"operator","name",this.operators,c.operatorSelectSelector,"grid-col-3");this.sandbox.dom.append(e,f),this.sandbox.dom.append(e,g),this.sandbox.dom.append(e,h),this.sandbox.dom.append(this.$container,e)},j=function(a,b,c,d,e,f){var g=[],h=null,i=this.sandbox.dom.createElement('<div class="'+f+'"></div>'),j=this.sandbox.dom.createElement('<select class="form-element '+e+'"></select>');return d.forEach(function(d){h=this.sandbox.translate(d[c]),g.push(d[b]===a?'<option value="'+d[b]+'" selected>'+h+"</option>":'<option value="'+d[b]+'">'+h+"</option>")}.bind(this)),this.sandbox.dom.append(j,g.join("")),this.sandbox.dom.append(i,j),i},k=function(){var a=this.sandbox.translate(this.options.translations.addButton),c=this.sandbox.dom.createElement(b.button.call(this,this.options.ids.addButton,a));this.sandbox.dom.append(this.$container,c)};return{initialize:function(){this.options=this.sandbox.util.extend(!0,{},a,this.options),this.options.ids={loader:"operator-selection-"+this.options.instanceName+"-loader",container:"operator-selection-"+this.options.instanceName+"-container",addButton:"operator-selection-"+this.options.instanceName+"-add-button"},f.call(this),this.fetchOperatorsAndFields()},fetchOperatorsAndFields:function(){var a,b;this.options.operatorsUrl&&"string"==typeof this.options.operatorsUrl&&this.options.fieldsUrl&&"string"==typeof this.options.fieldsUrl?(a=this.sandbox.util.load(this.options.operatorsUrl),b=this.sandbox.util.load(this.options.fieldsUrl),this.sandbox.data.when(a,b).done(function(a,b){this.operators=a[0]._embedded.items,this.fields=b[0],this.render()}.bind(this))):this.sandbox.logger.error("Url for fields and/or operators not specified or invalid!")},render:function(){this.$container=this.sandbox.dom.createElement(b.container(this.options.ids.container)),this.sandbox.dom.append(this.options.el,this.$container),this.options.data&&h.call(this),k.call(this),g.call(this),this.sandbox.dom.show(this.$container),this.sandbox.emit(d.call(this))}}});